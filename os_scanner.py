#!/usr/bin/env python

import nmap

nm = nmap.PortScanner()
target = raw_input("Enter the target to scan: ")

nm.scan(target, arguments='-sS -Pn -O')

'''
if nm['127.0.0.1'].has_key('osclass'):
    for osclass in nm['127.0.0.1']['osclass']:
        print('OsClass.type : {0}'.format(osclass['type']))
        print('OsClass.vendor : {0}'.format(osclass['vendor']))
        print('OsClass.osfamily : {0}'.format(osclass['osfamily']))
        print('OsClass.osgen : {0}'.format(osclass['osgen']))
        print('OsClass.accuracy : {0}'.format(osclass['accuracy']))
        print('')
'''


if nm[target].has_key('osmatch'):
    for osmatch in nm[target]['osmatch']:
        print('Os Name : {0}'.format(osmatch['name']))
        print('Detection Accuracy : {0}'.format(osmatch['accuracy']))
        print('Osmatch Database Line : {0}'.format(osmatch['line']))
        print('')

'''
if nm['127.0.0.1'].has_key('fingerprint'):
    print('Fingerprint : {0}'.format(nm['127.0.0.1']['fingerprint']))
'''
