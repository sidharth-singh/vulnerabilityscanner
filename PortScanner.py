#!/usr/bin/env python

import socket
import sys
from datetime import datetime
import time

host = raw_input("Enter the host name or address to be scanned: ")
print "Pinging ..."
time.sleep(3)
print host + " is alive"
host_address = socket.gethostbyname(host)

open_ports = []
start_time = datetime.now()
try:
    ports = int(raw_input("Enter the number of ports to be scanned: "))
    print "Scanning the host.............."
    #print "\n"
    for port in range(ports+1):
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)
        reply = s.connect_ex((host_address, port))
        if reply == 0:
            try:
                service = socket.getservbyport(port)
                print "Port: " + str(port) + "(" + str(service) + ")" + " is open"
            except:
                print "Port: " + str(port) + " is open"
            open_ports.append(port)
            s.close()

except socket.error:
    print "\nError in creating the socket\nExiting now...."
    sys.exit()

except KeyboardInterrupt:
    print "\nForce Quiting Ctrl+C pressed...."
    sys.exit()

end_time = datetime.now()

total_time = end_time - start_time

print "\nScan completed in: " + str(total_time)
