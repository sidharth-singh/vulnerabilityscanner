#!/usr/bin/env python

import Ping
import Port_Scanner
import SQLi_Scan
import XSS_Scanner

def vscanning():
    print "\n"
    choice = int(raw_input("Select the vulnerability to scan:\n1. Sql-Injection\n2. Cross-Site Scripting\n3. Both SQLi and XSS\n"))

    if choice == 1:
	print "\n"
        SQLi_Scan.sqlmain(target)
    if choice == 2:
        print "\n"
        XSS_Scanner.xss_scanning(target)
    if choice == 3:
        print "\n"
        SQLi_Scan.sqlmain(target)
        print "\n"
        XSS_Scanner.xss_scanning(target)

print ".................................Vunerability Scanner................................"
print "\n"

target = raw_input("Enter the target name/address to be scanned: ")

target_ip = Ping.get_ip(target)

is_reachable = Ping.ping(target)
print "\n"

if is_reachable:
    open_ports = Port_Scanner.port_scan(target_ip)

    if 80 in open_ports:
        print "Initiating the scan........."
        vscanning()

